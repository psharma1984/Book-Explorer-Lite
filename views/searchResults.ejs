<%- include("partials/head.ejs") %>
<%- include("partials/header.ejs") %>
<nav class="navbar navbar-expand-lg bg-body-tertiary"> 
  <div class="container-fluid d-flex ">
    <h6 style="color:black;font-style:italic">Search Results(<%= query %>)</h6>
  </div>
  <div class="container-fluid d-flex justify-content-end">
      <div class="d-flex">
        <a class="navbar-brand fs-5 text-success text-decoration-underline" href="/books">BooksList</a>   
        <a class="navbar-brand fs-5 text-success text-decoration-underline" href="/books/favoriteList" > Favorites(<%= favorites.length %>)</a>
      </div>
      </div>
  </nav>
  <br/>
  <br/>
<div class="container">
    <% if (results.length > 0) { %>
    <div class="row">
      <% results.forEach((result) => { %>
        <div class="col-12 col-md-4 col-lg-2 mb-3 d-flex flex-column align-items-center justify-content-center">   
          <div class="mb-3">
            <div class="d-flex align-items-center justify-content-center" style="height: 180px;">       
              <img src="<%= result.coverImage %>" alt="Book Cover" class="img-fluid" style="max-width: 100%; max-height: 100%; transition: transform 0.3s ease-in-out;" onclick="navigateToBookDetail('<%= result._id %>')">   
            </div>           
          </div>  
        </div>
    <% }) %>    
    </div> 
    <!-- Pagination Controls -->
    <div class="col-12 d-flex justify-content-center bg-light p-2 bg-opacity-25">
      <% if (currentPage > 1) { %>
        <a style="font-weight:bold;color:green;margin-right: 15px;" href="?page=<%= currentPage - 1 %>&search=<%= query %>">Previous</a>
      <% } %>

      <p class="text-dark ">Page <%= currentPage %> of <%= totalPages %></p>

      <% if (currentPage < totalPages) { %>
        <a style="font-weight:bold;color:green;margin-left: 15px;" href="?page=<%= currentPage + 1 %>&search=<%= query %>">Next</a>
      <% } %>
    </div>       
    <% } else { %>
        <p>No results found</p>
    <% } %>    
</div>

     <script>
     
      function navigateToBookDetail(bookId){
        var bookDetailURL = '/books/'+ bookId;
        window.location.href = bookDetailURL;
      }

    </script>
   
<%- include("partials/footer.ejs") %>