<%- include("partials/head.ejs") %>
<%- include("partials/header.ejs") %>
  <p><%= user.name.toUpperCase() %>'s favorites: <%= user.favorites.length %></p>
<div class="container">
 <div class="row">

  <div class="col-sm-4 text-center">    
      <img src="<%= book.coverImage %>" alt="Book Cover" class="img-fluid border-end border-black border-5 ">   
      <!-- Reviews Section -->
      <div class="mt-3">
        <h3 style="color:black;text-decoration:bold;text-align:left">Reviews</h3>
        <div class="scroll-box bg-light p-2 text-dark bg-opacity-50 rounded" style="max-height: 200px; overflow-y: auto;  padding: 10px;text-align:left">
          <% if (reviews && reviews.length) { %>
            <% reviews.forEach((review) => { %>
              <% review.comment.forEach((comment) => { %>
                <p> <%= comment %>...says <strong ><%= review.user.name %></strong></p>
                <hr />
              <% }); %>
            <% }); %>
          <% } else { %>
            <p>No reviews yet.</p>
          <% } %>
        </div>
      </div>         
  </div>

  <div class="col-sm-8 text-start bg-light p-2 text-dark bg-opacity-50">
    <h1 class="h1 fw-bold"> <%= book.title %></h1>
    <h4><%= book.author%></h4>
    <br/>
    <p class="fw-medium"><%= book.synopsis %></p>
    <form action="/books/favorites/<%= book._id %>" method="POST">
      <input type="hidden" name="_csrf" value="<%= _csrf %>">
      <button type="submit" class="btn btn-danger">Mark as Favorite</button>
    </form>
    <br />
    <form action="/books/review/<%= book._id %>" method="POST">
      <input type="hidden" name="_csrf" value="<%= _csrf %>">
      <div class="mb-3">
        <label for="comment" class="fw-medium">Review this Book:</label>
        <textarea class="form-control" id="comment" name="comment" rows="3"></textarea>
      </div>
      <button type="submit" class="btn btn-danger"> Submit Review</button>
    </form>

  </div>

 </div> 
</div>  
<%- include("partials/footer.ejs") %>